<!-- public/track.html -->
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>üîç ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Kanit&display=swap');

    body {
      font-family: 'Kanit', sans-serif;
      background: #e3f2fd;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }
      /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô <style> */
    .back-btn{
  position: fixed;
  top: 20px;
  left: 20px;
  background-color: #ff9800;
  color: white;
  padding: 10px 18px;
  border-radius: 8px;
  text-decoration: none;
  font-weight: bold;
  z-index: 1000;
}

/* ‚úÖ ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠: ‡πÄ‡∏≠‡∏≤ fixed ‡∏≠‡∏≠‡∏Å ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ä‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ */
@media (max-width: 768px){
  .back-btn{
    position: relative;
    top: auto;
    left: auto;
    margin: 12px auto 0;
    display: inline-block;
  }

  h2{
    margin-top: 12px; /* ‡∏•‡∏î‡∏£‡∏∞‡∏¢‡∏∞ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß */
    text-align: center;
  }
}

    .back-btn:hover {
      background-color: #f57c00;
    }

    h2 {
      margin-top: 40px;
      color: #1976d2;
    }

    form {
      background: #ffffff;
      padding: 20px 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    input[type="tel"] {
      padding: 12px 16px;
      font-size: 16px;
      border: 1.5px solid #90caf9;
      border-radius: 8px;
      margin-bottom: 12px;
      width: 260px;
      background-color: #f0faff;
    }

    button {
      background-color: #1976d2;
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    button:hover {
      background-color: #1565c0;
    }

    #results {
      margin-top: 30px;
      width: 90%;
      max-width: 600px;
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    #results p {
      margin: 8px 0;
    }

    hr {
      margin: 20px 0;
      border: none;
      border-top: 1px solid #ccc;
    }

    @media (max-width: 480px) {
      input[type="tel"], button {
        width: 100%;
      }

      form {
        width: 90%;
      }
    }
  .media-grid { display:flex; flex-wrap:wrap; gap:10px; margin-top:8px; }
  .media-grid img, .media-grid video { width:140px; height:100px; object-fit:cover; border-radius:8px; }
  .chip { display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; background:#e8f5e9; color:#1b5e20; }
  /* ===== Mobile Responsive for track ===== */
.container { max-width: 1100px; margin: 0 auto; }
.table-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; }

input, button, select {
  max-width: 100%;
  font-size: 16px; /* ‡∏Å‡∏±‡∏ô iOS ‡∏ã‡∏π‡∏°‡πÄ‡∏≠‡∏á */
}

@media (max-width: 768px) {
  body { padding: 14px !important; }
  h2 { font-size: 20px; }
  .search { width: 100% !important; }
  .btn { width: 100%; padding: 12px 14px; }

  table { display: block; width: 100%; border: none; box-shadow: none; background: transparent; }
  thead { display: none; }
  tbody { display: block; }

  tr {
    display: block;
    background: #fff;
    margin: 12px 0;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,.06);
    overflow: hidden;
  }

  td {
    display: flex;
    justify-content: space-between;
    gap: 12px;
    padding: 10px 12px;
    border: none !important;
    border-bottom: 1px solid #f1f5f9 !important;
    text-align: left !important;
    align-items: flex-start;
  }

  td:last-child { border-bottom: none !important; }

  /* ‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á ‡πÇ‡∏î‡∏¢‡∏≠‡∏≤‡∏®‡∏±‡∏¢ data-label */
  td::before {
    content: attr(data-label);
    font-weight: 700;
    color: #334155;
    min-width: 120px;
    flex: 0 0 120px;
  }

  #results img, #results video { max-width: 160px !important; max-height: 160px !important; }

}
/* ===== Fullscreen Media Modal (Mobile friendly) ===== */
/* ===== Media Modal (One clean version) ===== */
.media-modal{ position:fixed; inset:0; z-index:99999; display:none; }
.media-modal__backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.70); }

.media-modal__content{
  position:absolute;
  left:50%; top:50%;
  transform:translate(-50%,-50%);
  width:min(96vw, 980px);
  height:min(92vh, 820px);
  background:#fff;
  border-radius:14px;
  overflow:hidden;
  display:flex;
  flex-direction:column;
}

.media-modal__header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 12px;
  border-bottom:1px solid #e5e7eb;
  background:#f8fafc;
}

.media-modal__title{ font-weight:700; color:#0f172a; }

.media-modal__close{
  border: none;
  cursor: pointer;

  width: 42px;
  height: 42px;
  border-radius: 999px;

  background: #111827;   /* ‡∏î‡∏≥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö ‡∏î‡∏π‡πÅ‡∏û‡∏á */
  color: #fff;

  font-size: 22px;
  line-height: 42px;
  text-align: center;

  box-shadow: 0 8px 18px rgba(0,0,0,0.25);
  transition: transform .15s ease, opacity .15s ease;
}

.media-modal__close:active{
  transform: scale(0.92);
  opacity: 0.9;
}




.media-modal__body{
  padding:12px;
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}

/* ‡∏£‡∏π‡∏õ/‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÉ‡∏´‡πâ‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏ï‡πá‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á */
.media-modal__stack{
  display:flex;
  flex-direction:column;
  gap:14px;
}


.media-modal__stack img,
.media-modal__stack video{
  width:100%;
  height:auto;
  max-height:76vh;
  object-fit:contain;
  border-radius:12px;
  background:#0000000a;
}

.media-modal__stack video{ display:block; }

.thumb{
  width:140px;
  height:100px;
  object-fit:cover;
  border-radius:8px;
  cursor:pointer;
}
/* ‡πÉ‡∏´‡πâ thumb ‡∏ä‡∏ô‡∏∞‡πÄ‡∏™‡∏°‡∏≠‡πÉ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö media-grid */
.media-grid .thumb { width:140px; height:100px; object-fit:cover; }

.media-modal img, .media-modal video{
  max-width: 100% !important;
  max-height: 76vh !important;
  width: 100% !important;
  height: auto !important;
}
/* ‚úÖ FIX: ‡πÉ‡∏´‡πâ Modal ‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (Messenger/Safari) */
@media (max-width: 768px) {
  .media-modal__content{
    left: 0 !important;
    top: 0 !important;
    transform: none !important;
    width: 100vw !important;
    height: 100vh !important;
    border-radius: 0 !important;
  }

  .media-modal__body{
    padding: 12px !important;
  }

  .media-modal__stack{
    width: 100% !important;
  }

  .media-modal__stack img,
  .media-modal__stack video{
    display: block !important;
    width: 100% !important;
    max-height: calc(100vh - 74px) !important; /* ‡∏´‡∏±‡∏Å‡∏™‡πà‡∏ß‡∏ô header */
    object-fit: contain !important;
  }
}

@media (max-width: 768px){
  .back-btn{
    width: calc(100% - 28px);
    text-align: center;
    border-radius: 12px;
  }
  h2{ padding: 0 10px; }
}

  </style>
</head>
<body>

  <a href="/choose.html" class="back-btn">‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</a>

  <h2>üîç ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</h2>
  <form id="trackForm">
    <input type="tel" id="phone" required placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ ‡πÄ‡∏ä‡πà‡∏ô 0891234567" />
    <button type="submit">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
  </form>

  <div id="results"></div>

  <script>
  function formatDate(dateString) {
  if (!dateString) return '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏ß‡∏•‡∏≤';

  let s = String(dateString).trim();

  // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö "YYYY-MM-DD HH:mm:ss" -> "YYYY-MM-DDTHH:mm:ss"
  s = s.replace(' ', 'T');

  // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ timezone ‡∏ï‡∏¥‡∏î‡∏°‡∏≤ (‡πÑ‡∏°‡πà‡∏°‡∏µ Z ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ +07:00 / -xx:xx)
  // ‡πÉ‡∏´‡πâ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô UTC ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ï‡∏¥‡∏° Z
  const hasTZ = /([zZ]|[+\-]\d{2}:?\d{2})$/.test(s);
  if (!hasTZ && /^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(s)) {
    s += 'Z';
  }

  const d = new Date(s);
  if (isNaN(d)) return '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ';

  return d.toLocaleString('th-TH', {
    timeZone: 'Asia/Bangkok',
    year: 'numeric', month: '2-digit', day: '2-digit',
    hour: '2-digit', minute: '2-digit', second: '2-digit',
    hour12: false
  });
}


  async function fetchRequests(phone) {
  const res = await fetch('/track-requests', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ phone })
  });

  const data = await res.json();
  const resultsDiv = document.getElementById('results');
  resultsDiv.innerHTML = '';

  if (!Array.isArray(data) || data.length === 0) {
    resultsDiv.textContent = '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á';
    return;
  }

  data.forEach(row => {
    const photos = parsePhoto(row.photo);
    const completedFiles = photos.filter(it => {
  if (!it) return false;

  // ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô object ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏ô‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô completed
  if (typeof it === 'object') {
    return it.from === 'completed' || it.tag === 'completed';
  }

  // ‚úÖ string ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà completed (‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏õ‡∏Å‡∏ï‡∏¥)
  return false;
});



    let html = `
      <hr/>
      <p><strong>üìÑ ‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á:</strong> ${row.id}</p>
      <p><strong>üìù ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°:</strong> ${row.message}</p>
      <p><strong>üïì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á:</strong> ${formatDate(row.created_at)}</p>
      <p><strong>üìå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${row.status || '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£'}</p>
    `;

    if (row.status === '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô' && row.completed_at) {
      html += `<p><span class="chip">‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${formatDate(row.completed_at)}</span></p>`;
    }

    if (row.status === '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥' && row.reject_reason) {
      html += `<p><strong>‚ùó ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•:</strong> ${row.reject_reason}</p>`;
    }

    
    // üîΩ ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ/‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏ö‡∏ï‡∏≠‡∏ô "‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô"
if (completedFiles.length > 0) {
  const safeFiles = completedFiles.filter(it => {
    const raw = typeof it === 'string' ? it : (it?.url || '');
    const u = String(raw).trim();
    return /^https?:\/\//i.test(u) || u.startsWith('uploads/') || u.startsWith('/uploads/');
  });

  if (safeFiles.length === 0) {
    html += `
      <div style="margin-top:8px; color:#999; font-size:13px;">
        üìÅ ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö (‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô) ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Å‡πà‡∏≤‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏à‡∏∂‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÑ‡∏î‡πâ
      </div>
    `;
  } else {
    const thumbs = safeFiles.slice(0, 4).map(it => {
      const url = typeof it === 'string' ? normUrl(it) : normUrl(it.url);
      const isVideo = (typeof it === 'object' && it.type === 'video') || /\.(mp4|mov|avi)(\?|$)/i.test(url);
      
        return isVideo
  ? `<video muted class="thumb" playsinline onclick='openMediaModal(${JSON.stringify([it])},"‡πÑ‡∏ü‡∏•‡πå")'>
       <source src="${url}" type="video/mp4">
     </video>`
  : `<img class="thumb" src="${url}" alt="" onclick='openMediaModal(${JSON.stringify([it])},"‡πÑ‡∏ü‡∏•‡πå")'>`;

    }).join('');

    html += `
      <div style="margin-top:8px;">
        <strong>üì∑ ‡πÑ‡∏ü‡∏•‡πå (‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô):</strong>
        <div class="media-grid">${thumbs}</div>
        <button style="margin-top:8px" onclick='showImages(${JSON.stringify(safeFiles)})'>‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
      </div>
    `;
  }
} 
    resultsDiv.innerHTML += html;
  });
}

  document.addEventListener("DOMContentLoaded", () => {
    const savedPhone = localStorage.getItem("phone");

    if (savedPhone) {
      // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡∏ã‡πà‡∏≠‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏Å‡∏î‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
      document.getElementById("trackForm").style.display = "none";
      fetchRequests(savedPhone);
    } else {
      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ö‡∏≠‡∏£‡πå ‚Üí ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥
      document.getElementById('trackForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const phone = document.getElementById('phone').value;
        localStorage.setItem("phone", phone); // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡∏£‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤
        fetchRequests(phone);
      });
    }
  });
</script>
<script>
  function normUrl(u) {
  if (!u) return '';

  u = String(u).trim();

  // 1) ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô URL ‡πÄ‡∏ï‡πá‡∏° (Cloudinary/https) ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏¢
  if (/^https?:\/\//i.test(u)) return u;

  // 2) ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö /uploads/... ‡πÅ‡∏•‡∏∞ uploads/...
  if (u.startsWith('/uploads/')) return encodeURI(u);
  if (u.startsWith('uploads/')) return encodeURI('/' + u);

  // 3) ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏•‡πâ‡∏ß‡∏ô ‡πÜ (‡πÄ‡∏ä‡πà‡∏ô 1766...on Twitter.jpeg) -> ‡πÄ‡∏î‡∏≤‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô /uploads
  return encodeURI('/uploads/' + u);
}


 function openMediaModal(files, titleText = '‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö') {
  const modal = document.getElementById('mediaModal');
  const body  = document.getElementById('mediaModalBody');
  const title = document.getElementById('mediaModalTitle');

  title.textContent = titleText;
  body.innerHTML = '';

  const safe = (files || []).filter(it => {
    const raw = typeof it === 'string' ? it : (it?.url || '');
    const u = String(raw).trim();
    return /^https?:\/\//i.test(u) || u.startsWith('uploads/') || u.startsWith('/uploads/');
  });

  if (safe.length === 0) {
    body.innerHTML = `<div style="color:#64748b">‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏î‡πâ</div>`;
  } else {
    body.innerHTML = safe.map(it => {
      const url = typeof it === 'string' ? normUrl(it) : normUrl(it.url);
      const isVideo =
        (typeof it === 'object' && it.type === 'video') ||
        /\.(mp4|mov|avi|webm)(\?|$)/i.test(url);

      return isVideo
        ? `<video controls playsinline preload="metadata">
             <source src="${url}">
           </video>`
        : `<img src="${url}" alt="">`;
    }).join('');
  }

  modal.style.display = 'block';
  document.body.style.overflow = 'hidden';

  // ‡∏õ‡∏¥‡∏î‡∏î‡πâ‡∏ß‡∏¢ ESC (‡∏Ñ‡∏≠‡∏°) + ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ö‡∏≤‡∏á‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
  document.addEventListener('keydown', escToClose);
}

function escToClose(e) {
  if (e.key === 'Escape') closeMediaModal();
}

function closeMediaModal() {
  const modal = document.getElementById('mediaModal');
  modal.style.display = 'none';
  document.getElementById('mediaModalBody').innerHTML = '';
  document.body.style.overflow = '';
  document.removeEventListener('keydown', escToClose);
}

function showImages(images) {
  openMediaModal(images, '‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î');
}




  function parsePhoto(val) {
    if (!val) return [];
    try { return Array.isArray(val) ? val : JSON.parse(val); }
    catch { return []; }
  }
</script>



<div id="mediaModal" class="media-modal">
  <div class="media-modal__backdrop" onclick="closeMediaModal()"></div>

  <div class="media-modal__content" role="dialog" aria-modal="true">
    <div class="media-modal__header">
      <div id="mediaModalTitle" class="media-modal__title">‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</div>
      <button type="button" class="media-modal__close" onclick="closeMediaModal()">‚úï</button>
    </div>

    <div class="media-modal__body">
      <div id="mediaModalBody" class="media-modal__stack"></div>
    </div>
  </div>
</div>



</body>
</html>
